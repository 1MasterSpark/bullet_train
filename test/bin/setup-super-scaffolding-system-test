#!/usr/bin/env bash

rails g model TestSite team:references name:string other_attribute:string url:text sort_order:integer
rails g model TestPage test_site:references name:string path:text
rails g model Project team:references name:string
rails g model Projects::Deliverable project:references name:string
rails g model Objective projects_deliverable:references name:string
rails g model Personality::CharacterTrait objective:references name:string
rails g model Personality::Note character_trait:references name:string
rails g model Personality::Reactions::Response note:references name:string

bin/super-scaffold crud TestSite Team name:text_field other_attribute:text_field url:text_field --sidebar="fal fa-globe-stand" --sortable
bin/super-scaffold crud TestPage TestSite,Team name:text_field path:text_field
bin/super-scaffold crud Project Team name:text_field description:trix_editor --sidebar="fal fa-cogs"
bin/super-scaffold crud Projects::Deliverable Project,Team name:text_field description:trix_editor
bin/super-scaffold crud Objective Projects::Deliverable,Project,Team name:text_field description:trix_editor
bin/super-scaffold crud Personality::CharacterTrait Objective,Projects::Deliverable,Project,Team name:text_field description:trix_editor
bin/super-scaffold crud Personality::Note Personality::CharacterTrait,Objective,Projects::Deliverable,Project,Team name:text_field description:trix_editor
bin/super-scaffold crud Personality::Reactions::Response Personality::Note,Personality::CharacterTrait,Objective,Projects::Deliverable,Project,Team name:text_field description:trix_editor

sed -i "s/\@response/\@response_object/g" test/controllers/api/v1/personality/reactions/responses_endpoint_test.rb

rails g migration add_project_id_to_test_sites project:references
bin/super-scaffold crud-field TestSite project_id:super_select[class_name=Project]

sed -i "s/raise .*/team\.projects/g" app/models/test_site.rb

rake db:migrate
rake db:test:prepare
